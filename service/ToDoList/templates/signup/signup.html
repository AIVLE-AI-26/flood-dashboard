{% extends 'main/navbar.html' %}

{% load static %}
{% block styles %}
<link rel="stylesheet" href="{% static 'css/signup.css' %}">
<title>회원가입</title>
{% endblock %}

{% block content %}
<canvas class="background-canvas"></canvas>
<div class="form-container-signup">
    <h2>회원가입</h2>
    <div class="signup-container">
      <form method="POST" class="needs-validation" novalidate>
        {% csrf_token %}
        {{ form.non_field_errors }}
        <div class="signup-group">
            <label class="signup-label" for="{{ form.username.id_for_label }}">아이디</label>
            {{ form.username }}
            <div class="invalid-feedback">
                {% if form.username.errors %}
                    {{ form.username.errors }}
                {% endif %}
            </div>
        </div>
        <div class="signup-group">
            <label for="{{ form.password1.id_for_label }}">비밀번호</label>
            {{ form.password1 }}
            <div class="invalid-feedback">
                {% if form.password1.errors %}
                    {{ form.password1.errors }}
                {% endif %}
            </div>
        </div>
        <div class="signup-group">
            <label for="{{ form.password2.id_for_label }}">비밀번호 확인</label>
            {{ form.password2 }}
            <div class="invalid-feedback">
                {% if form.password2.errors %}
                    {{ form.password2.errors }}
                {% endif %}
            </div>
        </div>
        <div class="signup-group">
            <label for="{{ form.email.id_for_label }}">이메일</label>
            {{ form.email }}
            <div class="invalid-feedback">
                {% if form.email.errors %}
                    {{ form.email.errors }}
                {% endif %}
            </div>
        </div>
        <div class="signup-group">
            <label for="{{ form.role.id_for_label }}">사용자 유형</label>
            {{ form.role }}
            <div class="invalid-feedback">
                {% if form.role.errors %}
                    {{ form.role.errors }}
                {% endif %}
            </div>
        </div>
        <div class="signup-btn-container">
            <button type="submit" class="btn btn-primary login-btn">회원가입</button>
        </div>
      </form>
    </div>
</div>
<script>
    (function () {
        'use strict';
        var forms = document.querySelectorAll('.needs-validation');
        Array.prototype.slice.call(forms)
            .forEach(function (form) {
                form.addEventListener('submit', function (event) {
                    if (!form.checkValidity()) {
                        event.preventDefault();
                        event.stopPropagation();
                    }
                    form.classList.add('was-validated');
                }, false);
            });
    })();
</script>
<script>
    const canvas = document.querySelector('.background-canvas');
    const context = canvas.getContext('2d');
    const drops = [];

    function resizeCanvas() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    }

    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    class Drop {
        constructor(index, x, y, speed, length) {
            this.index = index;
            this.x = x;
            this.y = y;
            this.speed = speed;
            this.length = length;
            this.draw();
        }

        draw() {
            context.beginPath();
            context.strokeStyle = '#FFFFFF';
            context.moveTo(this.x, this.y);
            context.lineTo(this.x, this.y + this.length);
            context.stroke();
            context.closePath();
        }
    }

    function render() {
        context.clearRect(0, 0, canvas.width, canvas.height);

        drops.forEach((drop) => {
            drop.y += drop.speed;
            if (drop.y > canvas.height) {
                drop.y = 0;
                drop.x = Math.random() * canvas.width;
                drop.speed = Math.random() * 3 + 1;
                drop.length = Math.random() * 5 + 2;
            }

            drop.draw();
        });

        requestAnimationFrame(render);
    }

    for (let i = 0; i < 500; i++) {
        const tempX = Math.random() * canvas.width;
        const tempY = Math.random() * canvas.height;
        const tempSpeed = Math.random() * 3 + 1;
        const tempLength = Math.random() * 5 + 2;

        drops.push(new Drop(i, tempX, tempY, tempSpeed, tempLength));
    }
    render();
</script>
{% endblock %}
